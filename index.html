<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å£è‡­ï¼†å¥åº·ãƒªã‚¹ã‚¯è¨ºæ–­ | ä¸‹é–¢å¸‚</title>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700;900&display=swap');
        body { font-family: 'Noto Sans JP', sans-serif; letter-spacing: -0.01em; color: #0F172A; -webkit-tap-highlight-color: transparent; }
        .page { display: none; }
        .active { display: block; animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; } }
        .bg-main { background-color: #F8FAFC; }
        .progress-bar { transition: width 0.4s ease; }
        .opt-btn-text { font-size: 1.1rem !important; font-weight: 800; color: #0F172A; }
        .score-blue { color: #0ea5e9; } .bg-blue-tag { background-color: #e0f2fe; color: #0369a1; }
        .score-yellow { color: #eab308; } .bg-yellow-tag { background-color: #fefce8; color: #854d0e; }
        .score-red { color: #ef4444; } .bg-red-tag { background-color: #fef2f2; color: #991b1b; }
        .my-icon { position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px; z-index: 100; border-radius: 50%; box-shadow: 0 4px 12px rgba(0,0,0,0.15); object-fit: cover; border: 2px solid white; }
    </style>
</head>
<body class="bg-main">

    <img src="my-icon.png" class="my-icon" alt="Brand Icon">

    <header class="bg-white border-b sticky top-0 z-50 px-4 py-3 shadow-sm">
        <div class="max-w-md mx-auto flex justify-between items-center">
            <span class="text-sky-600 font-black text-lg italic tracking-tighter">KUCHI-CHECK</span>
            <span id="q-counter" class="text-[10px] font-black bg-sky-100 text-sky-600 px-3 py-1 rounded-full uppercase">READY</span>
        </div>
        <div class="max-w-md mx-auto w-full bg-slate-100 h-1.5 mt-2 rounded-full overflow-hidden">
            <div id="progress" class="progress-bar bg-sky-400 h-full" style="width: 0%"></div>
        </div>
    </header>

    <main class="max-w-md mx-auto p-4 pb-24">
        
        <section id="page-start" class="page active py-6 text-center">
            <h1 class="text-3xl font-black mb-4 leading-tight">ã‚ãªãŸã®æ¯ã¯<br><span class="text-sky-500 text-4xl underline decoration-yellow-300 decoration-8">ã€Œä½“ã®é¡ã€</span>ã§ã™</h1>
            
            <div class="bg-white p-6 rounded-[2.5rem] shadow-xl border border-slate-100 mb-8 text-left">
                <h2 class="text-sky-600 font-black text-lg mb-3">ã“ã®è¨ºæ–­ã§ã‚ã‹ã‚‹ã“ã¨</h2>
                <ul class="text-sm font-bold text-slate-600 space-y-3">
                    <li class="flex items-start"><span class="text-sky-400 mr-2">â—</span>ãŠå£ã®ãƒ‹ã‚ªã‚¤ã®åŸå› ãŒã€Œä¸€æ™‚çš„ãªã‚‚ã®ã€ã‹ã€Œç—…æ°—ã®ã‚µã‚¤ãƒ³ã€ã‹ã‚’åˆ†æã—ã¾ã™ã€‚</li>
                    <li class="flex items-start"><span class="text-sky-400 mr-2">â—</span>ç”Ÿæ´»ç¿’æ…£ã‚„ã‚¹ãƒˆãƒ¬ã‚¹ã‹ã‚‰ãã‚‹ä½“èª¿ã®å¤‰åŒ–ã‚’ãƒã‚§ãƒƒã‚¯ã—ã¾ã™ã€‚</li>
                    <li class="flex items-start"><span class="text-sky-400 mr-2">â—</span>ã‚ãªãŸã«æœ€é©ãªã‚»ãƒ«ãƒ•ã‚±ã‚¢ã¨ä¸‹é–¢å¸‚ã®å¥åº·æƒ…å ±ã‚’ææ¡ˆã—ã¾ã™ã€‚</li>
                </ul>
                <p id="liff-status" class="text-xs text-slate-400 font-medium italic mt-6 text-center">LINEã¨æ¥ç¶šã—ã¦ã„ã¾ã™...</p>
            </div>
            
            <button id="start-btn" onclick="startQuiz()" class="w-full bg-sky-500 text-white font-black py-6 rounded-3xl shadow-lg active:scale-95 transition-all text-xl disabled:bg-slate-300" disabled>è¨ºæ–­ã‚’é–‹å§‹ã™ã‚‹</button>
            <p class="text-[10px] text-slate-400 mt-4">â€»ã“ã®è¨ºæ–­ã¯åŒ»ç™‚è¨ºæ–­ã«ä»£ã‚ã‚‹ã‚‚ã®ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>
        </section>

        <section id="page-q" class="page">
            <div class="bg-white rounded-[3rem] p-8 shadow-2xl border border-sky-50 mt-4 relative">
                <div class="flex justify-between items-start mb-6">
                    <div id="q-cat-label" class="inline-block px-4 py-1.5 rounded-full text-[10px] font-black tracking-widest text-white bg-sky-400 uppercase">CATEGORY</div>
                    <button id="back-btn" onclick="prevQuestion()" class="hidden text-[10px] font-black text-slate-400 flex items-center bg-slate-100 px-3 py-1.5 rounded-full active:bg-slate-200">
                        <span class="mr-1">â—€</span> æˆ»ã‚‹
                    </button>
                </div>
                <h2 id="q-text" class="text-xl font-black mb-8 leading-tight text-slate-800 min-h-[4rem]"></h2>
                <div id="q-image-area" class="mb-8 hidden">
                    <p class="text-[10px] font-black text-sky-500 mb-4 bg-sky-50 inline-block px-3 py-1 rounded-lg italic">ğŸ“¸ é¡ã§è‡ªåˆ†ã®èˆŒã®çŠ¶æ…‹ã‚’æ¯”è¼ƒ</p>
                    <div class="grid grid-cols-3 gap-2 text-[9px] font-bold text-slate-400 text-center">
                        <div><img src="tongue1.jpg" class="rounded-xl border mb-1 aspect-square object-cover shadow-sm">çœŸã£ç™½</div>
                        <div><img src="tongue2.jpg" class="rounded-xl border mb-1 aspect-square object-cover shadow-sm">ã†ã£ã™ã‚‰</div>
                        <div><img src="tongue3.jpg" class="rounded-xl border mb-1 aspect-square object-cover shadow-sm">ãã‚Œã„</div>
                    </div>
                </div>
                <div id="options-container" class="space-y-4"></div>
            </div>
        </section>

        <section id="page-result" class="page">
            <h2 class="text-center font-black text-2xl mb-2 tracking-tighter italic text-slate-800 uppercase">Diagnostic Report</h2>
            <p class="text-center text-sky-600 font-black text-sm mb-6 underline">ç¾åœ¨ã®å£è‡­ãƒªã‚¹ã‚¯åˆ†æ</p>
            
            <div class="grid grid-cols-2 gap-3 mb-4">
                <div class="bg-white p-5 rounded-[2.5rem] shadow-xl border border-sky-50 text-center">
                    <p class="text-[10px] font-black mb-1 uppercase opacity-60">ä¸€æ™‚çš„ãƒªã‚¹ã‚¯</p>
                    <div class="flex items-center justify-center font-black"><span id="score-1" class="text-5xl">0</span><span class="text-sm ml-1">%</span></div>
                    <p id="label-1" class="text-[10px] font-black rounded-full py-1 mt-3"></p>
                </div>
                <div class="bg-white p-5 rounded-[2.5rem] shadow-xl border border-sky-50 text-center">
                    <p class="text-[10px] font-black mb-1 uppercase opacity-60">ç—…çš„ãƒªã‚¹ã‚¯</p>
                    <div class="flex items-center justify-center font-black"><span id="score-2" class="text-5xl">0</span><span class="text-sm ml-1">%</span></div>
                    <p id="label-2" class="text-[10px] font-black rounded-full py-1 mt-3"></p>
                </div>
            </div>

            <div class="bg-sky-50/50 p-4 rounded-2xl mb-8 border border-sky-100">
                <div class="text-[9px] text-slate-500 font-bold leading-relaxed space-y-1">
                    <p><b class="text-sky-600">â—ä¸€æ™‚çš„ãƒªã‚¹ã‚¯ï¼š</b> ç–²ã‚Œãƒ»ç·Šå¼µãƒ»ä¹¾ç‡¥ãªã©ã«ã‚ˆã‚‹ä¸€æ™‚çš„ãªãƒ‹ã‚ªã‚¤ã®ç™ºç”Ÿã—ã‚„ã™ã•ã§ã™ã€‚</p>
                    <p><b class="text-sky-600">â—ç—…çš„ãƒªã‚¹ã‚¯ï¼š</b> æ­¯å‘¨ç—…ã‚„èƒƒè…¸ã®ä¸èª¿ãªã©ã€èº«ä½“çš„ãªè¦å› ãŒåŸå› ã¨ãªã£ã¦ã„ã‚‹å¯èƒ½æ€§ã®é«˜ã•ã§ã™ã€‚</p>
                </div>
            </div>

            <div id="result-message" class="bg-white p-6 rounded-3xl mb-10 shadow-md border-l-8 text-sm font-bold text-slate-700 leading-relaxed"></div>

            <div class="mb-10">
                <h3 class="font-black text-sky-600 text-sm mb-4 flex items-center"><span class="w-3 h-3 bg-sky-400 mr-2 rounded-full"></span>ã‚ãªãŸå°‚ç”¨ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹</h3>
                <div id="advice-list" class="grid gap-3"></div>
            </div>

            <div class="bg-white rounded-[2.5rem] p-6 shadow-xl border-2 border-sky-100 mb-10">
                <h3 class="font-black text-sky-600 text-sm mb-1 flex items-center"><span class="w-3 h-3 bg-sky-400 mr-2 rounded-full"></span>ç¿’æ…£åŒ–ãƒªãƒã‚¤ãƒ³ãƒ‰</h3>
                <div class="space-y-3 mt-4">
                    <div class="p-4 bg-sky-50 rounded-2xl flex flex-col border border-sky-100">
                        <div class="flex items-center justify-between">
                            <label class="flex items-center font-bold text-sm"><input type="checkbox" class="w-5 h-5 mr-3 accent-sky-500" checked>æœã®æ°´åˆ†è£œçµ¦</label>
                            <input type="time" value="07:00" class="text-xs p-1 rounded border">
                        </div>
                    </div>
                    <div class="p-4 bg-sky-50 rounded-2xl flex flex-col border border-sky-100">
                        <div class="flex items-center justify-between">
                            <label class="flex items-center font-bold text-sm"><input type="checkbox" class="w-5 h-5 mr-3 accent-sky-500">èˆŒã®ã‚±ã‚¢</label>
                            <input type="time" value="08:00" class="text-xs p-1 rounded border">
                        </div>
                    </div>
                </div>
                <button onclick="alert('ãƒªãƒã‚¤ãƒ³ãƒ‰ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼')" class="w-full mt-4 bg-sky-500 text-white font-black py-4 rounded-2xl text-sm shadow-md active:scale-95 transition-all">ä¿å­˜ã™ã‚‹</button>
            </div>

            <div class="bg-white border-2 border-slate-100 rounded-[2.5rem] p-8 mb-6 shadow-xl">
                <h3 class="text-xl font-black mb-4 italic text-sky-500 text-center">SHIMONOSEKI INFO</h3>
                <div class="space-y-3">
                    <a href="https://www.city.shimonoseki.lg.jp/soshiki/42/5040.html" target="_blank" class="block w-full bg-slate-700 text-center font-bold py-4 rounded-2xl text-sm no-underline text-white active:bg-slate-800">ç‰¹å®šå¥è¨ºï¼ˆ40æ­³ã€œ74æ­³ï¼‰</a>
                    <a href="https://www.city.shimonoseki.lg.jp/soshiki/51/5768.html" target="_blank" class="block w-full bg-slate-700 text-center font-bold py-4 rounded-2xl text-sm no-underline text-white active:bg-slate-800">å¥åº·è¨ºæŸ»ï¼ˆå…¨èˆ¬ï¼‰</a>
                </div>
            </div>

            <div class="mb-4">
                <a href="https://www.city.shimonoseki.lg.jp/uploaded/attachment/86987.pdf" target="_blank" class="w-full bg-slate-800 text-white py-5 rounded-[2rem] shadow-lg flex items-center justify-center no-underline active:bg-slate-700 text-white">
                    <span class="text-2xl mr-3">ğŸ“„</span>
                    <div class="text-left">
                        <p class="text-[10px] font-black text-sky-400 uppercase leading-none mb-1">Official List</p>
                        <p class="text-sm font-black text-white">ä¸‹é–¢å¸‚ å®Ÿæ–½åŒ»ç™‚æ©Ÿé–¢ä¸€è¦§(PDF)</p>
                    </div>
                    <span class="ml-4 text-slate-500">â†—ï¸</span>
                </a>
            </div>

            <div class="mb-10">
                <a href="https://www.google.com/maps/search/%E6%AD%AF%E7%A7%91%E5%8C%BB%E9%99%A2/" target="_blank" class="w-full bg-white border-2 border-sky-100 py-5 rounded-[2rem] shadow-md flex items-center justify-center no-underline active:bg-sky-50 text-slate-700">
                    <span class="text-2xl mr-3">ğŸ“</span>
                    <div class="text-left">
                        <p class="text-[10px] font-black text-sky-500 uppercase leading-none mb-1">Clinic Search</p>
                        <p class="text-sm font-black text-slate-700 leading-none">è¿‘ãã®æ­¯ç§‘åŒ»é™¢ã‚’æ¢ã™</p>
                    </div>
                    <span class="ml-4 text-sky-200">â–¶ï¸</span>
                </a>
            </div>

            <button onclick="liff.closeWindow()" class="w-full bg-slate-400 text-white font-black py-6 rounded-3xl text-lg active:scale-95 shadow-md">è¨ºæ–­ã‚’çµ‚äº†ã™ã‚‹</button>
        </section>
    </main>

    <script>
        const LIFF_ID = "2008714027-cuYvg8O7"; 
        const GAS_URL = "https://script.google.com/macros/s/AKfycbz66OWd1XQd37zZAN7TQka0gq0KWDvkoXtX8xvSZhpkNKOwMcOsLivP_HVb1v_TbH5rXw/exec"; 

        const questions = [
            { axis: 1, cat: "èµ·åºŠãƒ»ç©ºè…¹", text: "æœèµ·ããŸã¨ãã‚„ã€ãŠè…¹ãŒç©ºã„ã¦ã„ã‚‹ã¨ãã«ç‰¹ã«ãŠå£ãŒè‡­ã†ã€‚", labels: ["ã‚ˆãã‚ã‚‹","ãŸã¾ã«ã‚ã‚‹","ãªã„"], advice: "æœä¸€ç•ªã®æ°´åˆ†è£œçµ¦ãŒã€çˆ½ã‚„ã‹ã•ã‚’ä½œã‚‹ã‚³ãƒ„ã§ã™ã€‚" },
            { axis: 1, cat: "èˆŒã®æ±šã‚Œ", text: "é¡ã§èˆŒã‚’è¦‹ãŸã¨ãã€è¡¨é¢ãŒç™½ãåšãè¦†ã‚ã‚Œã¦ã„ã‚‹ã€‚", labels: ["çœŸã£ç™½","ã†ã£ã™ã‚‰","ãã‚Œã„"], advice: "æœã®æ­¯ç£¨ãå‰ã«ã€ŒèˆŒãƒ–ãƒ©ã‚·ã€ã§å„ªã—ãã‚±ã‚¢ã—ã¾ã—ã‚‡ã†ã€‚", hasImage: true },
            { axis: 1, cat: "ã‚¹ãƒˆãƒ¬ã‚¹", text: "ç¾åœ¨ã€ä»•äº‹ã‚„å®¶åº­ãªã©ã§å¼·ã„ã‚¹ãƒˆãƒ¬ã‚¹ã‚’æ„Ÿã˜ã¦ã„ã‚‹ã€‚", labels: ["å¸¸ã«å¼·ã„","æ™‚ã€…","ã‚ã¾ã‚Šãªã„"], advice: "æ·±å‘¼å¸ã‚’3å›ã™ã‚‹ã ã‘ã§ã‚‚å”¾æ¶²ã¯å‡ºã‚„ã™ããªã‚Šã¾ã™ã€‚" },
            { axis: 1, cat: "ãƒãƒã¤ã", text: "ç·Šå¼µã™ã‚‹ã¨å£ã®ä¸­ãŒãƒãƒãƒãƒã—ã€è©±ã—ã«ãã„ã¨æ„Ÿã˜ã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚", labels: ["ã‚ˆãã‚ã‚‹","ãŸã¾ã«ã‚ã‚‹","ãªã„"], advice: "å”¾æ¶²è…ºãƒãƒƒã‚µãƒ¼ã‚¸ã§ã€ã‚µãƒ©ã‚µãƒ©å”¾æ¶²ã‚’å‘¼ã³æˆ»ã—ã¾ã—ã‚‡ã†ã€‚" },
            { axis: 1, cat: "æ°´åˆ†æ‘‚å–", text: "æ—¥ä¸­ã€æ°´ã‚„ãŠèŒ¶ãªã©ã®æ°´åˆ†ã‚’ã‚ã¾ã‚Šæ‘‚ã‚‰ãªã„ã€‚", labels: ["æ‘‚ã‚‰ãªã„","æ™‚ã€…","ã“ã¾ã‚ã«æ‘‚ã‚‹"], advice: "ä¸€å£ãšã¤ã€ã“ã¾ã‚ã«å£ã‚’æ½¤ã™ç¿’æ…£ã‚’ã¤ã‘ã¾ã—ã‚‡ã†ã€‚" },
            { axis: 1, cat: "ãƒ›ãƒ«ãƒ¢ãƒ³", text: "ï¼ˆå¥³æ€§ã®æ–¹ï¼‰ç”Ÿç†å‰å¾Œã‚„æ›´å¹´æœŸã®æ™‚æœŸã«å½“ãŸã£ã¦ã„ã‚‹ã€‚", labels: ["ã¯ã„","ã©ã¡ã‚‰ã§ã‚‚ãªã„","ã„ã„ãˆ"], advice: "ä¸å¯§ãªæ­¯ç£¨ãã¨ã€ãŸã£ã·ã‚Šã®ä¼‘æ¯ã‚’å¤§åˆ‡ã«ã€‚" },
            { axis: 1, cat: "ä½“èª¿ãƒ»ç–²åŠ´", text: "ç¡çœ ä¸è¶³ã‚„ç–²ã‚ŒãŒæºœã¾ã£ã¦ã„ã¦ã€ä½“èª¿ãŒä¸‡å…¨ã§ã¯ãªã„ã€‚", labels: ["ã‹ãªã‚Šç–²åŠ´","ã‚„ã‚„ç–²ã‚Œ","å…ƒæ°—"], advice: "ä»Šæ—¥ã¯ã„ã¤ã‚‚ã‚ˆã‚Š30åˆ†æ—©ãå¯ã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿ" },
            { axis: 1, cat: "é£²é£Ÿ", text: "æ˜¨å¤œã€ãƒ‹ãƒ³ãƒ‹ã‚¯æ–™ç†ã‚’é£Ÿã¹ãŸã‚Šã€ãŠé…’ã‚’å¤šã‚ã«é£²ã‚“ã ã€‚", labels: ["ã¯ã„","å°‘ã—","ã„ã„ãˆ"], advice: "ãƒªãƒ³ã‚´ã‚¸ãƒ¥ãƒ¼ã‚¹ãŒä¸€æ™‚çš„ãªãƒ‹ã‚ªã‚¤ã®åˆ†è§£ã‚’åŠ©ã‘ã¾ã™ã€‚" },
            { axis: 1, cat: "ã‚»ãƒ«ãƒ•ã‚±ã‚¢", text: "1æ—¥ã®æ­¯ç£¨ãå›æ•°ãŒã€2å›ä»¥ä¸‹ã§ã‚ã‚‹ã€‚", labels: ["1å›ä»¥ä¸‹","2å›","3å›ä»¥ä¸Š"], advice: "é£Ÿå¾Œã®ãƒ–ã‚¯ãƒ–ã‚¯ã†ãŒã„ã ã‘ã§ã‚‚ç´°èŒã®å¢—æ®–ã‚’æŠ‘ãˆã‚‰ã‚Œã¾ã™ã€‚" },
            { axis: 1, cat: "å£å‘¼å¸", text: "å¯ã¦ã„ã‚‹æ™‚ã«ã€å£ãŒé–‹ã„ã¦ã„ã‚‹ã¨æŒ‡æ‘˜ã•ã‚ŒãŸã“ã¨ãŒã‚ã‚‹ã€‚", labels: ["ã‚ˆãã‚ã‚‹","ãŸã¾ã«ã‚ã‚‹","ãªã„"], advice: "æ„è­˜çš„ãªé¼»å‘¼å¸ã¨ã€å¯ã‚‹å‰ã®æ°´åˆ†è£œçµ¦ã‚’å¤§åˆ‡ã«ã€‚" },
            { axis: 2, cat: "ç¶™ç¶šæ€§", text: "å£è‡­ã®æ‚©ã¿ãŒ2é€±é–“ä»¥ä¸Šã€é•·ãç¶šã„ã¦ã„ã‚‹ã€‚", labels: ["ãšã£ã¨","æ™‚ã€…","ãªã„"], advice: "é•·ãç¶šãå ´åˆã¯ã€ä¸€åº¦å°‚é–€å®¶ã®ãƒã‚§ãƒƒã‚¯ã‚’å—ã‘ã¾ã—ã‚‡ã†ã€‚" },
            { axis: 2, cat: "æ­¯ãã", text: "æ­¯ã‚’ç£¨ãã¨ãã€ç‰¹å®šã®å ´æ‰€ã‹ã‚‰è¡€ãŒå‡ºã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚", labels: ["æ¯å›","æ™‚ã€…","ãªã„"], advice: "å‡ºè¡€ã¯æ­¯å‘¨ç—…ã®ã‚µã‚¤ãƒ³ã€‚æ—©ã‚ã®å—è¨ºã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚" },
            { axis: 2, cat: "æ­¯ã®ç•°å¤‰", text: "æ­¯ãŒã‚°ãƒ©ã¤ã„ãŸã‚Šã€æ­¯ãããŒè…«ã‚ŒãŸã‚Šã—ã¦ã„ã‚‹å ´æ‰€ãŒã‚ã‚‹ã€‚", labels: ["ã‚ã‚‹","é•å’Œæ„Ÿ","ãªã„"], advice: "æ”¾ç½®ã¯å±é™ºã§ã™ã€‚æ—©ã‚ã«æ­¯ç§‘åŒ»é™¢ã¸ã€‚" },
            { axis: 2, cat: "ä»£è¬ã‚µã‚¤ãƒ³", text: "ä»¥å‰ã‚ˆã‚Šå–‰ãŒç•°å¸¸ã«æ¸‡ãã€ãƒˆã‚¤ãƒ¬ã®å›æ•°ãŒå¢—ãˆãŸã€‚", labels: ["ã‚ˆãã‚ã‚‹","ãŸã¾ã«","ãªã„"], advice: "å†…åˆ†æ³Œã®å¥è¨ºã§æ•°å€¤ã‚’ä¸€åº¦ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚" },
            { axis: 2, cat: "é¼»ãƒ»å–‰", text: "é¼»ãŒè©°ã¾ã‚Šã‚„ã™ã‹ã£ãŸã‚Šã€å–‰ã®å¥¥ã«é¼»æ°´ãŒè½ã¡ã‚‹æ„Ÿè¦šãŒã‚ã‚‹ã€‚", labels: ["ã‚ˆãã‚ã‚‹","ãŸã¾ã«","ãªã„"], advice: "è€³é¼»ç§‘ã¸ã®ç›¸è«‡ãŒæ”¹å–„ã®è¿‘é“ã«ãªã‚‹ã“ã¨ã‚‚ã‚ã‚Šã¾ã™ã€‚" },
            { axis: 2, cat: "ã ã‚‹ã•", text: "ãŠé…’ã‚’é£²ã¾ãªã„ã®ã«ã€ä½“ãŒã ã‚‹ã‹ã£ãŸã‚Šè¶³ãŒã‚€ãã¿ã‚„ã™ã„ã€‚", labels: ["ã‚ˆãã‚ã‚‹","ãŸã¾ã«","ãªã„"], advice: "å†…è‡“ã®ç–²ã‚ŒãŒåŸå› ã‹ã‚‚ã€‚å®šæœŸå¥è¨ºã‚’ç¿’æ…£ã«ã—ã¾ã—ã‚‡ã†ã€‚" },
            { axis: 2, cat: "æ¶ˆåŒ–å™¨", text: "èƒƒã‚‚ãŸã‚Œã€èƒ¸ç„¼ã‘ã€ã¾ãŸã¯æ…¢æ€§ã®èƒƒç—›ã«æ‚©ã¾ã•ã‚Œã¦ã„ã‚‹ã€‚", labels: ["ã‚ˆãã‚ã‚‹","ãŸã¾ã«","ãªã„"], advice: "æ¶ˆåŒ–ã«è‰¯ã„é£Ÿäº‹ã‚’å¿ƒãŒã‘ã€ä½“ã‚’å†…å´ã‹ã‚‰åŠ´ã‚ã£ã¦ã€‚" },
            { axis: 2, cat: "ã‚¿ãƒã‚³", text: "æ—¥å¸¸çš„ã«ã‚¿ãƒã‚³ã‚’å¸ã£ã¦ã„ã‚‹ã€‚", labels: ["å¸ã†","ä»¥å‰å¸ã£ã¦ã„ãŸ","å¸ã‚ãªã„"], advice: "ã‚¿ãƒã‚³ã¯æ·±åˆ»ãªç—…æ°—ã‚’éš ã—ã¾ã™ã€‚æœ¬æ•°ã‚’æ¸›ã‚‰ã™ä¸€æ­©ã‹ã‚‰ã€‚" },
            { axis: 2, cat: "è¡€ç³–å€¤ã‚µã‚¤ãƒ³", text: "æ€¥ã«ç”˜ã„ã‚‚ã®ãŒæ¬²ã—ããªã£ãŸã‚Šã€é£Ÿå¾Œã«å¼·ã„çœ æ°—ã‚’æ„Ÿã˜ã‚‹ã€‚", labels: ["ã‚ˆãã‚ã‚‹","ãŸã¾ã«","ãªã„"], advice: "é£Ÿå¾Œã®å¼·ã„çœ æ°—ã¯è¡€ç³–å€¤ã®ã‚µã‚¤ãƒ³ã€‚å¥è¨ºã‚’å—ã‘ã¾ã—ã‚‡ã†ã€‚" },
            { axis: 2, cat: "ã‚€ãã¿", text: "å¤•æ–¹ã«é´ãŒãã¤ãæ„Ÿã˜ã‚‹ã“ã¨ãŒå¢—ãˆãŸã‚Šã—ãŸã€‚", labels: ["ã‚ˆãã‚ã‚‹","ãŸã¾ã«","ãªã„"], advice: "è»½ã„ã‚¹ãƒˆãƒ¬ãƒƒãƒã§ãŠå£ã¨å…¨èº«ã®å·¡ã‚Šã‚’è‰¯ãã—ã¾ã—ã‚‡ã†ã€‚" }
        ];

        let currentIdx = 0, answers = [], lineProfile = null;

        window.onload = async () => {
            try {
                await liff.init({ liffId: LIFF_ID });
                if (liff.isLoggedIn()) {
                    lineProfile = await liff.getProfile();
                    document.getElementById('liff-status').innerText = `${lineProfile.displayName}ã•ã‚“ã€æº–å‚™å®Œäº†ï¼`;
                    document.getElementById('start-btn').disabled = false;
                } else { liff.login(); }
            } catch (e) {
                document.getElementById('liff-status').innerText = "ãƒ‡ãƒ¢ãƒ¢ãƒ¼ãƒ‰èµ·å‹•ä¸­...";
                document.getElementById('start-btn').disabled = false;
            }
        };

        function startQuiz() { currentIdx = 0; answers = []; showPage('page-q'); updateQuestion(); }
        function showPage(id) { document.querySelectorAll('.page').forEach(p => p.classList.remove('active')); document.getElementById(id).classList.add('active'); window.scrollTo(0,0); }

        function updateQuestion() {
            const q = questions[currentIdx];
            document.getElementById('q-counter').innerText = `Q${currentIdx + 1} / 20`;
            document.getElementById('progress').style.width = `${((currentIdx + 1) / 20) * 100}%`;
            document.getElementById('q-cat-label').innerText = q.cat;
            document.getElementById('q-text').innerText = q.text;
            document.getElementById('q-image-area').classList.toggle('hidden', !q.hasImage);
            const backBtn = document.getElementById('back-btn');
            if (currentIdx > 0) backBtn.classList.remove('hidden'); else backBtn.classList.add('hidden');
            const container = document.getElementById('options-container');
            container.innerHTML = "";
            q.labels.forEach((label, i) => {
                const btn = document.createElement('button');
                btn.className = "w-full bg-white border-2 border-slate-100 p-6 rounded-3xl text-left shadow-sm active:bg-sky-50 flex justify-between items-center";
                btn.innerHTML = `<span class="opt-btn-text text-sm font-bold">${label}</span><span class="text-sky-300">â†’</span>`;
                btn.onclick = () => {
                    answers.push({ ...q, userScore: (i === 0 ? 1 : (i === 1 ? 0.5 : 0)) });
                    if (currentIdx < questions.length - 1) { currentIdx++; updateQuestion(); } else { showResult(); }
                };
                container.appendChild(btn);
            });
        }

        function prevQuestion() {
            if (currentIdx > 0) {
                currentIdx--;
                answers.pop();
                updateQuestion();
            }
        }

        function showResult() {
            showPage('page-result');
            let s1 = 0, s2 = 0;
            const adviceSet = [];
            answers.forEach(a => {
                let p = a.userScore * 10;
                if (a.axis === 1) s1 += p; else s2 += p;
                if (a.userScore >= 0.5) adviceSet.push(a.advice);
            });
            const renderScore = (score, scoreId, labelId) => {
                const el = document.getElementById(scoreId);
                const lbl = document.getElementById(labelId);
                el.innerText = Math.round(score);
                if (score <= 40) { el.className = "text-5xl score-blue"; lbl.innerText = "å®‰å¿ƒ"; lbl.className = "text-[10px] font-black bg-blue-tag px-4 py-1 rounded-full"; }
                else if (score <= 60) { el.className = "text-5xl score-yellow"; lbl.innerText = "æ³¨æ„"; lbl.className = "text-[10px] font-black bg-yellow-tag px-4 py-1 rounded-full"; }
                else { el.className = "text-5xl score-red"; lbl.innerText = "è­¦æˆ’"; lbl.className = "text-[10px] font-black bg-red-tag px-4 py-1 rounded-full"; }
            };
            renderScore(s1, 'score-1', 'label-1');
            renderScore(s2, 'score-2', 'label-2');
            const msgEl = document.getElementById('result-message');
            msgEl.innerText = s2 > 40 ? "ãŠå£ã®ä¸­ã«ç‰¹å®šã®ãƒ‹ã‚ªã‚¤åŸå› ãŒéš ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ä¸€åº¦ã€ä¸‹é–¢å¸‚ã®å¥è¨ºã§è©³ã—ããƒã‚§ãƒƒã‚¯ã—ã¦ã¿ã¾ã›ã‚“ã‹ï¼Ÿ" : "ç¾åœ¨ã¯å¤§ããªãƒªã‚¹ã‚¯ã¯è¦‹ã‚‰ã‚Œã¾ã›ã‚“ã€‚æ—¥é ƒã®æ°´åˆ†è£œçµ¦ã¨æ¸…æ½”ãªã‚±ã‚¢ã‚’ç¶šã‘ã¦ã„ãã¾ã—ã‚‡ã†ï¼";
            msgEl.className = `bg-white p-6 rounded-3xl mb-10 shadow-md border-l-8 ${s2 > 40 ? 'border-red-400' : 'border-sky-400'} text-sm font-bold text-slate-700`;

            document.getElementById('advice-list').innerHTML = [...new Set(adviceSet)].slice(0, 4).map(adv => `
                <div class="bg-white p-4 rounded-2xl border border-slate-100 shadow-sm text-xs font-bold text-slate-600 flex items-start">
                    <span class="text-sky-400 mr-2">â—</span>${adv}
                </div>
            `).join('');

            sendData(Math.round(s1), Math.round(s2));
        }

        async function sendData(s1, s2) {
            if (!lineProfile || !GAS_URL) return;
            const data = { name: lineProfile.displayName, userId: lineProfile.userId, s1: s1, s2: s2 };
            fetch(GAS_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            }).catch(e => console.error("Send Error:", e));
        }
    </script>
</body>
</html>
